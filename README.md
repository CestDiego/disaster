disaster.el â€“ Disassemble C/C++ code under cursor in Emacs
==========================================================

![Screenshot](http://i.imgur.com/vl2OD3P.png)

Disaster shows you assembly code for the C/C++ file being currently edited
in a separate window. If you're using Clang, it'll also hop to the line in
the assembly file that corresponds to to the C/C++ text under your cursor.
Seriously, *you should install Clang*.

Disaster tries to be smart about detecting the location of your Makefile and
will fall back to invoking clang or cc manually if there's no Makefile. For
more information, see `disaster`.

Installation
------------

Make sure to place `disaster.el` somewhere in the load-path and add the
following lines to your `.emacs` file to enable the `C-c C-d` shortcut to
invoke `disaster`:

    (eval-after-load 'cc-mode
      '(progn
         (require 'disaster)
         (defun my-c-mode-common-hook ()
           (define-key c-mode-base-map (kbd "C-c C-c") 'compile)
           (define-key c-mode-base-map (kbd "C-c C-d") 'disaster))
         (add-hook 'c-mode-common-hook 'my-c-mode-common-hook)))

Put these lines in your Makefile so it knows how to compile assembly:

    %.S: %.c   ; $(COMPILE.c)   -g -S $(OUTPUT_OPTION) $<
    %.S: %.cc  ; $(COMPILE.cc)  -g -S $(OUTPUT_OPTION) $<
    %.S: %.cpp ; $(COMPILE.cpp) -g -S $(OUTPUT_OPTION) $<

Function Documentation
----------------------

### (disaster &optional FILE LINE)

Shows assembly code for current line of C/C++ file.

Here's the logic path it follows:

- Is there a Makefile in this directory? Run `make bufname.S`.
- Or is there a Makefile in a parent directory? Run `make -C .. bufname.S`.
- Or is this a C file? Run `clang -g -O3 -S -o bufname.S bufname.c`
- Or is this a C++ file? Run `clang++ -g -O3 -S -o bufname.S bufname.c`
- If build failed, display errors in compile-mode.
- If build succeeded, open bufname.S in new window while maintaining focus.
- If clang -g output, jump and highlight corresponding line of assembly code.

For example, if you're editing lol.cc and have a Makefile in your
current directory (or a parent directory), then this function
will run `make -C project-root -k lol.S` to compile the object
to assembly and display it in a popup window with the current
source line focused. If make fails, a standard compile output log
will be displayed.

If FILE and LINE are not specified, the current editing location
is used.

### (disaster-find-project-root &optional LOOKS FILE)

General-purpose Heuristic to detect bottom directory of project.

This works by scanning parent directories of FILE (using
`disaster--find-parent-dirs`) for certain types of files like a
`.git/` directory or a `Makefile` (which is less preferred).

The canonical structure of LOOKS is a list of lists of files
to look for in each parent directory where sublists are ordered
from highest precedence to lowest.  However you may specify
LOOKS as a single string or a list of strings for your
convenience. If LOOKS is not specified, it'll default to
`disaster-project-root-files`.

-----
<div style="padding-top:15px;color: #d0d0d0;">
Markdown README file generated by
<a href="https://github.com/mgalgs/make-readme-markdown">make-readme-markdown.el</a>
</div>
